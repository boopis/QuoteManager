<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="viewport" content="width=device-width" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Form submitted</title>
<style>
/* -------------------------------------
    GLOBAL
------------------------------------- */
* {
  margin: 0;
  padding: 0;
  font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif;
  font-size: 100%;
  line-height: 1.6;
}
img {
  max-width: 100%;
}
body {
  -webkit-font-smoothing: antialiased;
  -webkit-text-size-adjust: none;
  width: 100%!important;
  height: 100%;
}
/* -------------------------------------
    ELEMENTS
------------------------------------- */
a {
  color: #348eda;
}
.btn-primary {
  text-decoration: none;
  color: #FFF;
  background-color: #348eda;
  border: solid #348eda;
  border-width: 10px 20px;
  line-height: 2;
  font-weight: bold;
  margin-right: 10px;
  text-align: center;
  cursor: pointer;
  display: inline-block;
  border-radius: 25px;
}
.btn-secondary {
  text-decoration: none;
  color: #FFF;
  background-color: #aaa;
  border: solid #aaa;
  border-width: 10px 20px;
  line-height: 2;
  font-weight: bold;
  margin-right: 10px;
  text-align: center;
  cursor: pointer;
  display: inline-block;
  border-radius: 25px;
}
.last {
  margin-bottom: 0;
}
.first {
  margin-top: 0;
}
.padding {
  padding: 10px 0;
}
/* -------------------------------------
    BODY
------------------------------------- */
table.body-wrap {
  width: 100%;
  padding: 20px;
}
table.body-wrap .container {
  border: 1px solid #f0f0f0;
}
/* -------------------------------------
    FOOTER
------------------------------------- */
table.footer-wrap {
  width: 100%;  
  clear: both!important;
}
.footer-wrap .container p {
  font-size: 12px;
  color: #666;
  
}
table.footer-wrap a {
  color: #999;
}
/* -------------------------------------
    TYPOGRAPHY
------------------------------------- */
h1, h2, h3 {
  font-family: "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;
  line-height: 1.1;
  margin-bottom: 15px;
  color: #000;
  margin: 40px 0 10px;
  line-height: 1.2;
  font-weight: 200;
}
h1 {
  font-size: 36px;
}
h2 {
  font-size: 28px;
}
h3 {
  font-size: 22px;
}
p, ul, ol {
  margin-bottom: 10px;
  font-weight: normal;
  font-size: 14px;
}
ul li, ol li {
  margin-left: 5px;
  list-style-position: inside;
}
/* ---------------------------------------------------
    RESPONSIVENESS
    Nuke it from orbit. It's the only way to be sure.
------------------------------------------------------ */
/* Set a max-width, and make it display as block so it will automatically stretch to that width, but will also shrink down on a phone or something */
.container {
  display: block!important;
  max-width: 600px!important;
  margin: 0 auto!important; /* makes it centered */
  clear: both!important;
}
/* Set the padding on the td rather than the div for Outlook compatibility */
.body-wrap .container {
  padding: 20px;
}
/* This should also be a block element, so that it will fill 100% of the .container */
.content {
  max-width: 600px;
  margin: 0 auto;
  display: block;
}
/* Let's make sure tables in the content area are 100% wide */
.content table {
  width: 100%;
}
</style>
</head>

<body bgcolor="#f6f6f6">

<!-- body -->
<table class="body-wrap">
  <tr>
    <td></td>
    <td class="container" bgcolor="#FFFFFF">

      <!-- content -->
      <div class="content">
      <table>
        <tr>
          <td>
            <% if @receiver.present? %>
              <h3>Dear, <%= @receiver %></h3>
            <% end %>
            <p>Your form <%= "(id: #{@form.id}, title: #{@form.name})" %>  has been submitted by <%= @user %> at <%= Time.now.strftime("%m/%d/%Y %I:%M%p") %></p>
          </td>
        </tr>
        <tr>
          <td>
            <h3>Request information</h3>
            <% @request.fields.each do |k,v| %>
              <%= content_tag :p, "#{v['label']}: #{v['request']}" %>
            <% end %>
          </td>
        </tr>
          <td>
            <h3>Analytics data</h3>
            <%= content_tag :p, "User OS: #{@request.os}" %>
            <%= content_tag :p, "Form was submitted from website: #{@request.referrer}" %>
            <%= content_tag :p, "User IP: #{@request.remote_ip}" %>
            <%= content_tag :p, "User language: #{@request.language}" %>
            <%= content_tag :p, "User browser: #{@request.browser}" %>
          </td>
        </tr>
        <tr>
          <td>
          <h3>Reply to your customer</h3>
          <%= form_tag request_update_state_url(@request.id), method: :post, authenticity_token: false do %>
            <%= hidden_field_tag :user, @user %>
            <%= hidden_field_tag :form_creator, @receiver %>
            <%= hidden_field_tag :form, @form.id %>
            <div>
            <label>Subject: </label>
            <%= text_field_tag :subject, '' %>
            </div>
            <div>
            <label>Body: </label>
            <%= text_area_tag :body, '' %>
            </div>
            <div>
            <%= button_tag 'Reply to Customer', class: 'button-primary' %>
            </div>
          <% end %>
        </td>
        </tr>
      </table>
      </div>
      <!-- /content -->
      
    </td>
    <td></td>
  </tr>
</table>
<!-- /body -->

<!-- footer -->
<table class="footer-wrap">
  <tr>
    <td></td>
    <td class="container">
      
      <!-- content -->
      <div class="content">
        <table>
          <tr>
            <td align="center">
              
            </td>
          </tr>
        </table>
      </div>
      <!-- /content -->
      
    </td>
    <td></td>
  </tr>
</table>
<!-- /footer -->

</body>
</html>
