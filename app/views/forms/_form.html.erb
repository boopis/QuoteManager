<%= form_for @form, html: { class: "form-inline builder formbuilder" } do |f| %>
  <% if @form.errors.any? %>
    <div class="alert alert-block alert-danger fade in">
      <button type="button" class="close" data-dismiss="alert" aria-hidden="true">Ã—</button>
      <h4><%= pluralize(@form.errors.count, "error") %> prohibited this form from being saved:</h4>
      <ul>
      <% @form.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>    
    </div>
  <% end %>

  <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 side pull-left">
    <div class="main-box">
      <h2>Contact Fields</h2>
      <div class="list-group">
        <%= link_to_add_contact_fields "Name", "name", "contact-name", "fa fa-user", f, :fields, @form %>
        <%= link_to_add_contact_fields "Phone", "phone", "contact-phone", "fa fa-phone", f, :fields, @form %>
        <%= link_to_add_contact_fields "Email", "email", "contact-email", "fa fa-envelope", f, :fields, @form %>
      </div>
      <h2>Custom Fields</h2>
      <div class="list-group">
        <%= link_to_add_fields "Text Field", "text", "fa fa-pencil", f, :fields %>
        <%= link_to_add_fields "File Field", "file", "fa fa-file-text", f, :fields %>
        <%= link_to_add_fields "In-page Field", "inpage", "fa fa-tag", f, :fields %>
        <%= link_to_add_fields "Paragraph", "paragraph", "fa fa-edit", f, :fields %>
        <%= link_to_add_fields "Radio", "radio", "fa fa-check-circle", f, :fields %>
        <%= link_to_add_fields "Select", "select", "fa fa-bars", f, :fields %>
        <%= link_to_add_fields "Check Box", "check_box", "fa fa-check-square", f, :fields %>
      </div>
    </div>
  </div>

  <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 main">

    <div class="main-box">
      <div class="tabs-wrapper">

        <ul class="nav nav-tabs">
          <li class="active"><a href="#rendered-form" data-toggle="tab">Form Render</a></li>
          <li class=""><a href="#user-guide" data-toggle="tab">Instructions</a></li>
        </ul>

        <div class="tab-content">
          <div class="tab-pane fade active in" id="rendered-form">
            <div class="added-fields">
              <div class="form-group">
              <%= f.label :name, "Form Name", class: "sr-only" %>
                <div class="input-group">
                  <span class="input-group-addon">
                    <i class="fa fa-file-o"></i>
                  </span>
                  <%= f.text_field :name, class: "form-control", placeholder: "Form Name" %>
                </div>
              </div>

              <div class="form-field-list">
                <% if @form.fields? %>
                  <% @form.fields.each do |id, field| %>
                    <%= f.fields_for :fields, OpenStruct.new(field), index: id do |field_type| %>
                      <%= render field['type'], f: field_type, options: field['options'] || [], required: field['validate']['validates_presence_of'] %>
                    <% end %>
                  <% end %>
                <% end %>
                <div class="form-field"></div>
              </div>

              <div class="actions">
                <%= f.submit class: "btn btn-success" %>
              </div>
            </div>
          </div>

          <div class="tab-pane fade" id="user-guide">
            <h2 class="pull-left">Guide</h2>
            <div class='clearfix'></div>
            <p>
              Form builder uses for creating request to vendor. You can add your form script by getting form script.  
              Every form is built by many fields.
              Fields are divided into 2 types: Contact fields and custom fields. 
            </p>
            <p>
              Contact fields consist of:
            </p>
            <ul>
              <li>Name field: To enter your name.</li>
              <li>Email field: To enter your email address.</li>
              <li>Phone field: To enter your phone number.</li>
            </ul>
            <p>
              Custom fields consist of:
            </p>

            <ul>
              <li>Text field: To add general information in string.</li>
              <li>
                Field field: To upload your image, product's specification. 
                You can upload image file (png, jpg, gif) or archive file (zip).
              </li>
              <li>
                In-page field: To enter HTML element's ID or class or product's option name which you want to get in your ecommerce website.
              </li>
              <li>
                Paragraph field: To contain your information in paragraph.
              </li>
              <li>
                Select field, radio field, checkbox field: To create multiple option choice. When your product's option have many value like color, size, type...
              </li>
            </ul>
            <p>
              You can add custom style / script by open css / js tab and enter your style / script to text area
            </p>
            <p>
              In settings tab, you can add email of your company. 
          </div>

        </div>
      </div>
    </div>
  </div>

  <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 settings">
    <div class="main-box">
      <div class="tabs-wrapper">
        <ul class="nav nav-tabs">
          <li class="active"><a href="#css" data-toggle="tab">CSS</a></li>
          <li class=""><a href="#js" data-toggle="tab">JS</a></li>
          <li class=""><a href="#settings" data-toggle="tab">Settings</a></li>
        </ul>

        <div class="tab-content">
          <div class="tab-pane fade active in" id="css">
            <%= form_custom_settings(@form.styles, "style", f)%>
          </div>

          <div class="tab-pane fade" id="js">
            <%= f.text_area :scripts, class: 'form-control', placeholder: 'Add your custom script' %>
          </div>

          <div class="tab-pane fade" id="settings">
            <%= form_custom_settings(@form.emails, "email", f)%>
          </div>
        </div>
      </div>
    </div>
  </div>

<% end %>

